{{set . "title" "Thread"}}
{{set . "class" "thread"}}
{{template "header.html" .}}

{{.flash.error}}

<h1>{{.thread.Topic}}
  <span> {{.thread.User.Name}} on {{formatDate .thread.Created}}</span>
</h1>
{{$userId := .user.UserId}}
{{range .posts}}
  {{$mine := eq .User.UserId $userId}}
  <div class="post{{if $mine}} mine{{end}}">
    <p>
      <strong>{{if $mine}}You{{else}}{{.User.Name}}{{end}}</strong> 
      wrote at {{formatDate .Created}}:</p>
    <p class="body">{{raw .Body}}</p>
  </div>
{{else}}
  <p>No posts yet, create one!</p>
{{end}}

<div class="new clearfix">
  <form method="POST" action="/threads/{{.thread.ThreadId}}/post">
    <textarea name="body" placeholder="Your message"></textarea>
    <input type="submit" value="Post" class="button pull-right">
  </form>
</div>

{{template "footer.html" .}}
